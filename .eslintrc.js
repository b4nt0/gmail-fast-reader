module.exports = {
  env: {
    es2021: true,
    node: true,
    jest: true
  },
  extends: [
    'eslint:recommended'
  ],
  parserOptions: {
    ecmaVersion: 2021,
    sourceType: 'module'
  },
  rules: {
    'no-unused-vars': ['warn', { argsIgnorePattern: '^_' }],
    'no-console': 'off',
    'no-undef': 'warn',
    'indent': ['warn', 2],
    'linebreak-style': 'off',
    'quotes': ['warn', 'single'],
    'semi': ['warn', 'always'],
    'no-inner-declarations': 'off'
  },
  globals: {
        'CardService': 'readonly',
        'GmailApp': 'readonly',
        'Logger': 'readonly',
        'MAX_TOKENS': 'readonly',
        'PROCESSING_STATUS': 'readonly',
        'PROCESSING_TIMEOUT_MS': 'readonly',
        'PropertiesService': 'readonly',
        'STATUS_REFRESH_INTERVAL_MS': 'readonly',
        'ScriptApp': 'readonly',
        'Session': 'readonly',
        'TOKENS_PER_CHAR': 'readonly',
        'UrlFetchApp': 'readonly',
        'Utilities': 'readonly',
        'analyzeEmailsWithOpenAI': 'readonly',
        'applyLabelsToInterestingEmails': 'readonly',
        'buildActiveWorkflowCard': 'readonly',
        'buildAnalysisPrompt': 'readonly',
        'buildConfigSuccessCard': 'readonly',
        'buildConfigurationCard': 'readonly',
        'buildErrorCard': 'readonly',
        'buildLatestRunStatsCard': 'readonly',
        'buildMainCard': 'readonly',
        'buildProgressCard': 'readonly',
        'buildProgressCardWithAutoRefresh': 'readonly',
        'buildProgressCardWithStatusButton': 'readonly',
        'buildQuickScanCard': 'readonly',
        'buildSummaryCard': 'readonly',
        'calculateDateRange': 'readonly',
        'calculateExpectedStartBuffer': 'readonly',
        'calculatePassiveWorkflowDateRange': 'readonly',
        'callOpenAIAPI': 'readonly',
        'checkAndHandleTimeout': 'readonly',
        'checkLock': 'readonly',
        'checkProcessingStatus': 'readonly',
        'cleanupChunkState': 'readonly',
        'cleanupChunkTiming': 'readonly',
        'cleanupProcessingState': 'readonly',
        'console': 'readonly',
        'deleteDispatcherTriggers': 'readonly',
        'ensureDispatcherScheduled': 'readonly',
        'estimateTokensForThread': 'readonly',
        'failProcessing': 'readonly',
        'fetchEmailThreadsForPassiveWorkflow': 'readonly',
        'fetchEmailThreadsFromGmail': 'readonly',
        'finalizeChunkedProcessing': 'readonly',
        'formatItemsForCard': 'readonly',
        'generateGmailPermalink': 'readonly',
        'generateSummaryHTML': 'readonly',
        'getConfiguration': 'readonly',
        'getFormBoolean': 'readonly',
        'getFormValue': 'readonly',
        'getProcessingState': 'readonly',
        'getTimezoneOptions': 'readonly',
        'getUserEmailAddress': 'readonly',
        'handleConfigSubmit': 'readonly',
        'handleEmergencyReset': 'readonly',
        'handleLabelSuggestions': 'readonly',
        'handleScanEmails': 'readonly',
        'handleTimeRangeSelection': 'readonly',
        'isConfigurationComplete': 'readonly',
        'isProcessingRunning': 'readonly',
        'labelEmails': 'readonly',
        'lock': 'readonly',
        'markChunkEnded': 'readonly',
        'markChunkStarting': 'readonly',
        'mergeResults': 'readonly',
        'onGmailMessageOpen': 'readonly',
        'onHomepageTrigger': 'readonly',
        'parseOpenAIResponse': 'readonly',
        'processDayInSubChunks': 'readonly',
        'processEmails': 'readonly',
        'processEmailsChunkedStep': 'readonly',
        'processEmailsInBatches': 'readonly',
        'releaseProcessingState': 'readonly',
        'resetAddonState': 'readonly',
        'runDispatcher': 'readonly',
        'runPassiveWorkflow': 'readonly',
        'safeBoolean': 'readonly',
        'safeString': 'readonly',
        'saveConfiguration': 'readonly',
        'saveLatestRunStats': 'readonly',
        'sendProcessingCompleteEmail': 'readonly',
        'sendProcessingErrorEmail': 'readonly',
        'sendProcessingTimeoutEmail': 'readonly',
        'sendSummaryEmail': 'readonly',
        'setExpectedNextChunkStart': 'readonly',
        'shouldIgnoreEmail': 'readonly',
        'startBackgroundEmailProcessing': 'readonly',
        'startProcessingState': 'readonly',
        'unlock': 'readonly',
        'updateProcessingProgress': 'readonly'
      
  },
  overrides: [
    {
      files: ['*.js'],
      globals: {
        'CardService': 'readonly',
        'GmailApp': 'readonly',
        'Logger': 'readonly',
        'MAX_TOKENS': 'readonly',
        'PROCESSING_STATUS': 'readonly',
        'PROCESSING_TIMEOUT_MS': 'readonly',
        'PropertiesService': 'readonly',
        'STATUS_REFRESH_INTERVAL_MS': 'readonly',
        'ScriptApp': 'readonly',
        'Session': 'readonly',
        'TOKENS_PER_CHAR': 'readonly',
        'UrlFetchApp': 'readonly',
        'Utilities': 'readonly',
        'analyzeEmailsWithOpenAI': 'readonly',
        'applyLabelsToInterestingEmails': 'readonly',
        'buildActiveWorkflowCard': 'readonly',
        'buildAnalysisPrompt': 'readonly',
        'buildConfigSuccessCard': 'readonly',
        'buildConfigurationCard': 'readonly',
        'buildErrorCard': 'readonly',
        'buildLatestRunStatsCard': 'readonly',
        'buildMainCard': 'readonly',
        'buildProgressCard': 'readonly',
        'buildProgressCardWithAutoRefresh': 'readonly',
        'buildProgressCardWithStatusButton': 'readonly',
        'buildQuickScanCard': 'readonly',
        'buildSummaryCard': 'readonly',
        'calculateDateRange': 'readonly',
        'calculateExpectedStartBuffer': 'readonly',
        'calculatePassiveWorkflowDateRange': 'readonly',
        'callOpenAIAPI': 'readonly',
        'checkAndHandleTimeout': 'readonly',
        'checkLock': 'readonly',
        'checkProcessingStatus': 'readonly',
        'cleanupChunkState': 'readonly',
        'cleanupChunkTiming': 'readonly',
        'cleanupProcessingState': 'readonly',
        'console': 'readonly',
        'deleteDispatcherTriggers': 'readonly',
        'ensureDispatcherScheduled': 'readonly',
        'estimateTokensForThread': 'readonly',
        'failProcessing': 'readonly',
        'fetchEmailThreadsForPassiveWorkflow': 'readonly',
        'fetchEmailThreadsFromGmail': 'readonly',
        'finalizeChunkedProcessing': 'readonly',
        'formatItemsForCard': 'readonly',
        'generateGmailPermalink': 'readonly',
        'generateSummaryHTML': 'readonly',
        'getConfiguration': 'readonly',
        'getFormBoolean': 'readonly',
        'getFormValue': 'readonly',
        'getProcessingState': 'readonly',
        'getTimezoneOptions': 'readonly',
        'getUserEmailAddress': 'readonly',
        'handleConfigSubmit': 'readonly',
        'handleEmergencyReset': 'readonly',
        'handleLabelSuggestions': 'readonly',
        'handleScanEmails': 'readonly',
        'handleTimeRangeSelection': 'readonly',
        'isConfigurationComplete': 'readonly',
        'isProcessingRunning': 'readonly',
        'labelEmails': 'readonly',
        'lock': 'readonly',
        'markChunkEnded': 'readonly',
        'markChunkStarting': 'readonly',
        'mergeResults': 'readonly',
        'onGmailMessageOpen': 'readonly',
        'onHomepageTrigger': 'readonly',
        'parseOpenAIResponse': 'readonly',
        'processDayInSubChunks': 'readonly',
        'processEmails': 'readonly',
        'processEmailsChunkedStep': 'readonly',
        'processEmailsInBatches': 'readonly',
        'releaseProcessingState': 'readonly',
        'resetAddonState': 'readonly',
        'runDispatcher': 'readonly',
        'runPassiveWorkflow': 'readonly',
        'safeBoolean': 'readonly',
        'safeString': 'readonly',
        'saveConfiguration': 'readonly',
        'saveLatestRunStats': 'readonly',
        'sendProcessingCompleteEmail': 'readonly',
        'sendProcessingErrorEmail': 'readonly',
        'sendProcessingTimeoutEmail': 'readonly',
        'sendSummaryEmail': 'readonly',
        'setExpectedNextChunkStart': 'readonly',
        'shouldIgnoreEmail': 'readonly',
        'startBackgroundEmailProcessing': 'readonly',
        'startProcessingState': 'readonly',
        'unlock': 'readonly',
        'updateProcessingProgress': 'readonly'
      
      
      },
      rules: {
        'no-undef': 'error' // Now enabled since we auto-generate globals from all .js files
      }
    }
  ]
};
